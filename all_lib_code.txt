// File generated by FlutterFire CLI.
// ignore_for_file: type=lint
import 'package:firebase_core/firebase_core.dart' show FirebaseOptions;
import 'package:flutter/foundation.dart'
    show defaultTargetPlatform, kIsWeb, TargetPlatform;

/// Default [FirebaseOptions] for use with your Firebase apps.
///
/// Example:
/// ```dart
/// import 'firebase_options.dart';
/// // ...
/// await Firebase.initializeApp(
///   options: DefaultFirebaseOptions.currentPlatform,
/// );
/// ```
class DefaultFirebaseOptions {
  static FirebaseOptions get currentPlatform {
    if (kIsWeb) {
      return web;
    }
    switch (defaultTargetPlatform) {
      case TargetPlatform.android:
        return android;
      case TargetPlatform.iOS:
        return ios;
      case TargetPlatform.macOS:
        return macos;
      case TargetPlatform.windows:
        return windows;
      case TargetPlatform.linux:
        throw UnsupportedError(
          'DefaultFirebaseOptions have not been configured for linux - '
          'you can reconfigure this by running the FlutterFire CLI again.',
        );
      default:
        throw UnsupportedError(
          'DefaultFirebaseOptions are not supported for this platform.',
        );
    }
  }

  static const FirebaseOptions web = FirebaseOptions(
    apiKey: 'AIzaSyD52SOM5s1kUJapsbN6RzF9KNfJEaBjlUc',
    appId: '1:724668581926:web:6b919e2aae679a93abfee7',
    messagingSenderId: '724668581926',
    projectId: 'fruit-hub-69f2d',
    authDomain: 'fruit-hub-69f2d.firebaseapp.com',
    storageBucket: 'fruit-hub-69f2d.appspot.com',
    measurementId: 'G-55VVR3M7XH',
  );

  static const FirebaseOptions android = FirebaseOptions(
    apiKey: 'AIzaSyD8qTPbFyIT_DxYA_JH1w5JdKmPXKsvhKY',
    appId: '1:724668581926:android:d3f5696093ad5ca0abfee7',
    messagingSenderId: '724668581926',
    projectId: 'fruit-hub-69f2d',
    storageBucket: 'fruit-hub-69f2d.appspot.com',
  );

  static const FirebaseOptions ios = FirebaseOptions(
    apiKey: 'AIzaSyCze2RrLntOKDAlFGN4R2NNlpS-dmXcO_4',
    appId: '1:724668581926:ios:e10b8dd4a196e27cabfee7',
    messagingSenderId: '724668581926',
    projectId: 'fruit-hub-69f2d',
    storageBucket: 'fruit-hub-69f2d.appspot.com',
    androidClientId: '724668581926-93r04hfcjd0244p3gr54fhnbo8mnnvfs.apps.googleusercontent.com',
    iosClientId: '724668581926-elmvt0tat0u6b3sg3msm1b8oi5usr0hv.apps.googleusercontent.com',
    iosBundleId: 'com.example.fruitHubDashboard',
  );

  static const FirebaseOptions macos = FirebaseOptions(
    apiKey: 'AIzaSyCze2RrLntOKDAlFGN4R2NNlpS-dmXcO_4',
    appId: '1:724668581926:ios:e10b8dd4a196e27cabfee7',
    messagingSenderId: '724668581926',
    projectId: 'fruit-hub-69f2d',
    storageBucket: 'fruit-hub-69f2d.appspot.com',
    androidClientId: '724668581926-93r04hfcjd0244p3gr54fhnbo8mnnvfs.apps.googleusercontent.com',
    iosClientId: '724668581926-elmvt0tat0u6b3sg3msm1b8oi5usr0hv.apps.googleusercontent.com',
    iosBundleId: 'com.example.fruitHubDashboard',
  );

  static const FirebaseOptions windows = FirebaseOptions(
    apiKey: 'AIzaSyD52SOM5s1kUJapsbN6RzF9KNfJEaBjlUc',
    appId: '1:724668581926:web:20e05eca3d79d9e7abfee7',
    messagingSenderId: '724668581926',
    projectId: 'fruit-hub-69f2d',
    authDomain: 'fruit-hub-69f2d.firebaseapp.com',
    storageBucket: 'fruit-hub-69f2d.appspot.com',
    measurementId: 'G-LL1ZW8X34F',
  );
}
import 'package:firebase_core/firebase_core.dart';
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/core/helper_functions/on_generate_routes.dart';
import 'package:fruits_hub_dashboard/core/service/get_it_service.dart';
import 'package:fruits_hub_dashboard/features/dashboard/presentation/views/dashboard_view.dart';
import 'package:fruits_hub_dashboard/firebase_options.dart';
import 'package:supabase_flutter/supabase_flutter.dart';

Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();

  // Firebase

  // Supabase
  await Supabase.initialize(
    url: 'https://iwhxwcqfcpcblvdifidv.supabase.co',
    anonKey:
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3aHh3Y3FmY3BjYmx2ZGlmaWR2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2MjA0NzgsImV4cCI6MjA4NTE5NjQ3OH0.BZp9PXcXXOJbb5Npy3wra7JO6Ed0M-JrRqYXSQ8F83c',
  );
  // GetIt setup بعد التهيئة
  setupGetit();

  runApp(const MainApp());
}

class MainApp extends StatelessWidget {
  const MainApp({super.key});

  @override
  Widget build(BuildContext context) {
    return const MaterialApp(
      initialRoute: DashboardView.routeName,
      onGenerateRoute: onGenerateRoute,
    );
  }
}
class CustomException implements Exception {
  final String message;

  CustomException({required this.message});

  @override
  String toString() {
    return message;
  }
}
abstract class Failure {
  final String message;
  Failure(this.message);
}

class ServerFailure extends Failure {
  ServerFailure(super.message);
}
import 'package:flutter/material.dart';

void buildSnackBar(BuildContext context, String message) {
  ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text(message)));
}
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/views/add_product_view.dart';
import 'package:fruits_hub_dashboard/features/dashboard/presentation/views/dashboard_view.dart';

Route<dynamic> onGenerateRoute(RouteSettings settings) {
  switch (settings.name) {
    case DashboardView.routeName:
      return MaterialPageRoute(builder: (context) => const DashboardView());
    case AddProductView.routeName:
      return MaterialPageRoute(builder: (context) => const AddProductView());
    default:
      return MaterialPageRoute(builder: (context) => const Scaffold());
  }
}
import 'dart:io';

import 'package:dartz/dartz.dart';
import 'package:fruits_hub_dashboard/core/errors/failures.dart';

abstract class ImagesRepo {
  Future<Either<Failure, String>> uploadImage(File image);
}
import 'dart:developer';
import 'dart:io';
import 'package:dartz/dartz.dart';
import '../errors/failures.dart';
import '../repos/images_repo.dart';
import '../service/storage_service.dart';
import '../utils/backend_endpoint.dart';

class ImagesRepoImpl implements ImagesRepo {
  final StorageService storageService;

  ImagesRepoImpl(this.storageService);

  @override
  Future<Either<Failure, String>> uploadImage(File image) async {
    try {
      final url = await storageService.uploadFile(
        image,
        BackendEndpoint.images,
      );
      return Right(url);
    } catch (e) {
      log('UPLOAD ERROR: $e');
      return Left(ServerFailure(e.toString()));
    }
  }
}
import 'package:dartz/dartz.dart';
import 'package:fruits_hub_dashboard/core/errors/failures.dart';
import 'package:fruits_hub_dashboard/domain/entities/add_product_input_entity.dart';

abstract class ProductsRepo {
  Future<Either<Failure, void>> addProduct(
    AddProductInputEntity addProductInputEntity,
  );
}
import 'package:dartz/dartz.dart';
import 'package:fruits_hub_dashboard/core/errors/failures.dart';
import 'package:fruits_hub_dashboard/core/repos/products_repo.dart';
import 'package:fruits_hub_dashboard/core/service/data_service.dart';
import 'package:fruits_hub_dashboard/core/utils/backend_endpoint.dart';
import 'package:fruits_hub_dashboard/domain/entities/add_product_input_entity.dart';
import 'package:fruits_hub_dashboard/features/add_product/data/models/add_product_input_model.dart';

class ProductsRepoImpl implements ProductsRepo {
  final DatabaseService databaseService;

  ProductsRepoImpl(this.databaseService);
  @override
  Future<Either<Failure, void>> addProduct(
    AddProductInputEntity addProductInputEntity,
  ) async {
    try {
      await databaseService.addData(
        path: BackendEndpoint.productsCollection,
        data: AddProductInputModel.fromEntity(addProductInputEntity).toJson(),
      );

      return const Right(null);
    } catch (e) {
      return Left(ServerFailure('Failed to add product'));
    }
  }
}
import 'dart:developer';

import 'package:bloc/bloc.dart';
import 'package:flutter/foundation.dart';

class CustomBlocObserver extends BlocObserver {
  @override
  void onTransition(Bloc bloc, Transition transition) {
    super.onTransition(bloc, transition);
    if (kDebugMode) {
      log('${bloc.runtimeType} $transition');
    }
  }

  @override
  void onChange(BlocBase bloc, Change change) {
    super.onChange(bloc, change);
    if (kDebugMode) {
      log('${bloc.runtimeType} $change');
    }
  }
}
abstract class DatabaseService {
  Future<void> addData({
    required String path,
    required Map<String, dynamic> data,
    String? documentId,
  });
  Future<Map<String, dynamic>> getData({
    required String path,
    required String docuementId,
  });

  Future<bool> checkIfDataExists({
    required String path,
    required String docuementId,
  });
}
import 'package:fruits_hub_dashboard/core/repos/images_repo.dart';
import 'package:fruits_hub_dashboard/core/repos/images_repo_impl.dart';
import 'package:fruits_hub_dashboard/core/repos/products_repo.dart';
import 'package:fruits_hub_dashboard/core/repos/products_repo_impl.dart';
import 'package:fruits_hub_dashboard/core/service/data_service.dart';
import 'package:fruits_hub_dashboard/core/service/storage_service.dart';
import 'package:fruits_hub_dashboard/core/service/suba_stoarge.dart';
import 'package:fruits_hub_dashboard/core/service/subastore_service.dart';
import 'package:get_it/get_it.dart';

final getIt = GetIt.instance;

void setupGetit() {
  getIt.registerSingleton<StorageService>(SubaStorage());
  getIt.registerSingleton<DatabaseService>(SubastoreService());

  getIt.registerSingleton<ImagesRepo>(
    ImagesRepoImpl(getIt.get<StorageService>()),
  );
  getIt.registerSingleton<ProductsRepo>(
    ProductsRepoImpl(getIt.get<DatabaseService>()),
  );
}
import 'dart:io';

abstract class StorageService {
  Future<String> uploadFile(File file, String path);
}
import 'package:supabase_flutter/supabase_flutter.dart';

import 'data_service.dart';

class SubastoreService implements DatabaseService {
  final SupabaseClient _client = Supabase.instance.client;

  @override
  Future<void> addData({
    required String path, // هنا path = table name
    required Map<String, dynamic> data,
    String? documentId, // optional, لو حبيت تحدد الـ id
  }) async {
    final table = _client.from(path);

    if (documentId != null) {
      // upsert row with specified id
      await table.upsert({'id': documentId, ...data});
    } else {
      // insert new row
      await table.insert(data);
    }
  }

  @override
  Future<Map<String, dynamic>> getData({
    required String path,
    required String docuementId,
  }) async {
    final table = _client.from(path);
    final response = await table.select().eq('id', docuementId).single();
    return response;
  }

  @override
  Future<bool> checkIfDataExists({
    required String path,
    required String docuementId,
  }) async {
    final table = _client.from(path);
    final response = await table.select().eq('id', docuementId);
    return response.isNotEmpty;
  }
}
import 'dart:io';
import 'package:path/path.dart' as p;
import 'package:supabase_flutter/supabase_flutter.dart';
import 'storage_service.dart';

class SubaStorage implements StorageService {
  final SupabaseClient _client = Supabase.instance.client;

  @override
  Future<String> uploadFile(File file, String path) async {
    final fileName = p.basename(file.path);
    final fullPath = '$path/$fileName';

    await _client.storage
        .from('product-images') // اسم الـ bucket
        .upload(
          fullPath,
          file,
          fileOptions: const FileOptions(upsert: true, cacheControl: '3600'),
        );

    final imageUrl = _client.storage.from('images').getPublicUrl(fullPath);

    return imageUrl;
  }
}
import 'package:flutter/material.dart';

abstract class AppColors {
  static const Color primaryColor = Color(0xff1F5E3B);
  static const Color lightPrimaryColor = Color(0xFF2D9F5D);
  static const Color secondaryColor = Color(0xFFF4A91F);
  static const Color lightSecondaryColor = Color(0xFFF8C76D);
}
// ignore_for_file: prefer_single_quotes
class Assets {
  Assets._();
  
  /// Assets for imagesAppIcon
  /// assets/images/app_icon.png
  static const String imagesAppIcon = "assets/images/app_icon.png";

  /// Assets for imagesApplIcon
  /// assets/images/appl_icon.svg
  static const String imagesApplIcon = "assets/images/appl_icon.svg";

  /// Assets for imagesCheck
  /// assets/images/Check.svg
  static const String imagesCheck = "assets/images/Check.svg";

  /// Assets for imagesFacebookIcon
  /// assets/images/facebook_icon.svg
  static const String imagesFacebookIcon = "assets/images/facebook_icon.svg";

  /// Assets for imagesFeaturedItemBackground
  /// assets/images/featured_item_background.svg
  static const String imagesFeaturedItemBackground = "assets/images/featured_item_background.svg";

  /// Assets for imagesFilter
  /// assets/images/filter.svg
  static const String imagesFilter = "assets/images/filter.svg";

  /// Assets for imagesGoogleIcon
  /// assets/images/google_icon.svg
  static const String imagesGoogleIcon = "assets/images/google_icon.svg";

  /// Assets for imagesLogo
  /// assets/images/logo.svg
  static const String imagesLogo = "assets/images/logo.svg";

  /// Assets for imagesNotification
  /// assets/images/notification.svg
  static const String imagesNotification = "assets/images/notification.svg";

  /// Assets for imagesPageViewItem1BackgroundImage
  /// assets/images/page_view_item1_background_image.svg
  static const String imagesPageViewItem1BackgroundImage = "assets/images/page_view_item1_background_image.svg";

  /// Assets for imagesPageViewItem1Image
  /// assets/images/page_view_item1_image.svg
  static const String imagesPageViewItem1Image = "assets/images/page_view_item1_image.svg";

  /// Assets for imagesPageViewItem2BackgroundImage
  /// assets/images/page_view_item2_background_image.svg
  static const String imagesPageViewItem2BackgroundImage = "assets/images/page_view_item2_background_image.svg";

  /// Assets for imagesPageViewItem2Image
  /// assets/images/page_view_item2_image.svg
  static const String imagesPageViewItem2Image = "assets/images/page_view_item2_image.svg";

  /// Assets for imagesPlant
  /// assets/images/plant.svg
  static const String imagesPlant = "assets/images/plant.svg";

  /// Assets for imagesProfileImage
  /// assets/images/profile_image.png
  static const String imagesProfileImage = "assets/images/profile_image.png";

  /// Assets for imagesSearchIcon
  /// assets/images/search_icon.svg
  static const String imagesSearchIcon = "assets/images/search_icon.svg";

  /// Assets for imagesSplashBottom
  /// assets/images/splash_bottom.svg
  static const String imagesSplashBottom = "assets/images/splash_bottom.svg";

  /// Assets for imagesVector
  /// assets/images/Vector.svg
  static const String imagesVector = "assets/images/Vector.svg";

  /// Assets for imagesVuesaxBoldHome
  /// assets/images/vuesax/bold/home.svg
  static const String imagesVuesaxBoldHome = "assets/images/vuesax/bold/home.svg";

  /// Assets for imagesVuesaxBoldProducts
  /// assets/images/vuesax/bold/products.svg
  static const String imagesVuesaxBoldProducts = "assets/images/vuesax/bold/products.svg";

  /// Assets for imagesVuesaxBoldShoppingCart
  /// assets/images/vuesax/bold/shopping-cart.svg
  static const String imagesVuesaxBoldShoppingCart = "assets/images/vuesax/bold/shopping-cart.svg";

  /// Assets for imagesVuesaxBoldUser
  /// assets/images/vuesax/bold/user.svg
  static const String imagesVuesaxBoldUser = "assets/images/vuesax/bold/user.svg";

  /// Assets for imagesVuesaxOutlineHome
  /// assets/images/vuesax/outline/home.svg
  static const String imagesVuesaxOutlineHome = "assets/images/vuesax/outline/home.svg";

  /// Assets for imagesVuesaxOutlineProducts
  /// assets/images/vuesax/outline/products.svg
  static const String imagesVuesaxOutlineProducts = "assets/images/vuesax/outline/products.svg";

  /// Assets for imagesVuesaxOutlineShoppingCart
  /// assets/images/vuesax/outline/shopping-cart.svg
  static const String imagesVuesaxOutlineShoppingCart = "assets/images/vuesax/outline/shopping-cart.svg";

  /// Assets for imagesVuesaxOutlineUser
  /// assets/images/vuesax/outline/user.svg
  static const String imagesVuesaxOutlineUser = "assets/images/vuesax/outline/user.svg";

  /// Assets for imagesWatermelonTest
  /// assets/images/watermelon_test.png
  static const String imagesWatermelonTest = "assets/images/watermelon_test.png";
}

import 'package:flutter/material.dart';

abstract class TextStyles {
  static const TextStyle bold13 = TextStyle(
    fontWeight: FontWeight.bold,
    fontSize: 13,
  );
  static const TextStyle bold23 = TextStyle(
    fontWeight: FontWeight.bold,
    fontSize: 23,
  );

  static const TextStyle semiBold13 = TextStyle(
    fontWeight: FontWeight.w600,
    fontSize: 13,
  );

  static const TextStyle regular13 = TextStyle(
    fontWeight: FontWeight.normal,
    fontSize: 13,
  );

  static const TextStyle bold16 = TextStyle(
    fontWeight: FontWeight.bold,
    fontSize: 16,
  );

  static const TextStyle bold19 = TextStyle(
    fontWeight: FontWeight.bold,
    fontSize: 19,
  );

  static const TextStyle semiBold16 = TextStyle(
    fontWeight: FontWeight.w600,
    fontSize: 16,
  );

  static const TextStyle bold28 = TextStyle(
    fontWeight: FontWeight.bold,
    fontSize: 28,
  );

  static const TextStyle regular22 = TextStyle(
    fontWeight: FontWeight.normal,
    fontSize: 22,
  );

  static const TextStyle semiBold11 = TextStyle(
    fontWeight: FontWeight.w600,
    fontSize: 11,
  );

  static const TextStyle medium15 = TextStyle(
    fontWeight: FontWeight.w500,
    fontSize: 15,
  );

  static const TextStyle regular26 = TextStyle(
    fontWeight: FontWeight.normal,
    fontSize: 26,
  );

  static const TextStyle regular16 = TextStyle(
    fontWeight: FontWeight.normal,
    fontSize: 16,
  );

  static const TextStyle regular11 = TextStyle(
    fontWeight: FontWeight.normal,
    fontSize: 11,
  );
}
class BackendEndpoint {
  static const addUserData = 'users';
  static const getUsersData = 'users';
  static const isUserExists = 'users';
  static const images = 'product-images';
  static const productsCollection = 'products';
}
import 'package:flutter/material.dart';

AppBar buildAppBar(String text) {
  return AppBar(title: Text(text));
}
import 'package:flutter/cupertino.dart';
import 'package:flutter/material.dart';

import '../utils/app_colors.dart';
import '../utils/app_text_styles.dart';


class CustomButton extends StatelessWidget {
  const CustomButton({super.key, required this.onPressed, required this.text});
  final VoidCallback onPressed;
  final String text;
  @override
  Widget build(BuildContext context) {
    return SizedBox(
      width: double.infinity,
      height: 54,
      child: TextButton(
        style: TextButton.styleFrom(
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(
              16,
            ),
          ),
          backgroundColor: AppColors.primaryColor,
        ),
        onPressed: onPressed,
        child: Text(
          text,
          style: TextStyles.bold16.copyWith(
            color: Colors.white,
          ),
        ),
      ),
    );
  }
}
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/core/utils/app_colors.dart';

class CustomCheckBox extends StatelessWidget {
  const CustomCheckBox({
    super.key,
    required this.isChecked,
    required this.onChecked,
  });
  final bool isChecked;
  final ValueChanged<bool> onChecked;
  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      onTap: () {
        onChecked(!isChecked);
      },
      child: AnimatedContainer(
        width: 24,
        height: 24,
        duration: const Duration(milliseconds: 100),
        decoration: ShapeDecoration(
          color: isChecked ? AppColors.primaryColor : Colors.white,
          shape: RoundedRectangleBorder(
            side: BorderSide(
              width: 1.50,
              color: isChecked ? Colors.transparent : const Color(0xFFDCDEDE),
            ),
            borderRadius: BorderRadius.circular(8),
          ),
        ),
        child:
            isChecked
                ? Icon(Icons.check, color: Colors.white, size: 16)
                : const SizedBox(),
      ),
    );
  }
}
import 'package:flutter/material.dart';
import 'package:modal_progress_hud_nsn/modal_progress_hud_nsn.dart';

class CustomProgressHud extends StatelessWidget {
  const CustomProgressHud({
    super.key,
    required this.isLoading,
    required this.child,
  });

  final bool isLoading;
  final Widget child;
  @override
  Widget build(BuildContext context) {
    return ModalProgressHUD(inAsyncCall: isLoading, child: child);
  }
}
import 'package:flutter/material.dart';

import '../utils/app_text_styles.dart';

class CustomTextFormField extends StatelessWidget {
  const CustomTextFormField({
    super.key,
    required this.hintText,
    required this.textInputType,
    this.maxLines = 1,
    this.suffixIcon,
    this.onSaved,
    this.obscureText = false,
  });
  final String hintText;
  final TextInputType textInputType;
  final int? maxLines;
  final Widget? suffixIcon;
  final void Function(String?)? onSaved;
  final bool obscureText;
  @override
  Widget build(BuildContext context) {
    return TextFormField(
      maxLines: maxLines,
      obscureText: obscureText,
      onSaved: onSaved,
      validator: (value) {
        if (value == null || value.isEmpty) {
          return 'هذا الحقل مطلوب';
        }
        return null;
      },
      keyboardType: textInputType,
      decoration: InputDecoration(
        suffixIcon: suffixIcon,
        hintStyle: TextStyles.bold13.copyWith(color: const Color(0xFF949D9E)),
        hintText: hintText,
        filled: true,
        fillColor: const Color(0xFFF9FAFA),
        border: buildBorder(),
        enabledBorder: buildBorder(),
        focusedBorder: buildBorder(),
      ),
    );
  }

  OutlineInputBorder buildBorder() {
    return OutlineInputBorder(
      borderRadius: BorderRadius.circular(4),
      borderSide: const BorderSide(width: 1, color: Color(0xFFE6E9E9)),
    );
  }
}
import 'dart:io';

class AddProductInputEntity {
  final String name;
  final String code;
  final String description;
  final num price;
  final File image;
  final bool isFeatured;
  String? imageUrl;

  AddProductInputEntity({
    required this.name,
    required this.code,
    required this.description,
    required this.price,
    required this.image,
    required this.isFeatured,
    this.imageUrl,
  });
}
import 'dart:io';

import 'package:fruits_hub_dashboard/domain/entities/add_product_input_entity.dart';

class AddProductInputModel {
  final String name;
  final String code;
  final String description;
  final num price;
  final File image;
  final bool isFeatured;
  String? imageUrl;

  AddProductInputModel({
    required this.name,
    required this.code,
    required this.description,
    required this.price,
    required this.image,
    required this.isFeatured,
    this.imageUrl,
  });

  factory AddProductInputModel.fromEntity(
    AddProductInputEntity addProductInputEntity,
  ) {
    return AddProductInputModel(
      name: addProductInputEntity.name,
      code: addProductInputEntity.code,
      description: addProductInputEntity.description,
      price: addProductInputEntity.price,
      image: addProductInputEntity.image,
      isFeatured: addProductInputEntity.isFeatured,
      imageUrl: addProductInputEntity.imageUrl,
    );
  }

  toJson() {
    return {
      'name': name,
      'code': code,
      'description': description,
      'price': price,
      'isFeatured': isFeatured,
      'imageUrl': imageUrl,
    };
  }
}
import 'dart:developer';

import 'package:bloc/bloc.dart';
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/core/repos/images_repo.dart';
import 'package:fruits_hub_dashboard/core/repos/products_repo.dart';
import 'package:fruits_hub_dashboard/domain/entities/add_product_input_entity.dart';
import 'package:meta/meta.dart';

part 'add_product_state.dart';

class AddProductCubit extends Cubit<AddProductState> {
  AddProductCubit(this.imagesRepo, this.productsRepo)
    : super(AddProductInitial());
  final ImagesRepo imagesRepo;
  final ProductsRepo productsRepo;

  Future<void> addProductC(
    AddProductInputEntity addProductInputEntity,
    BuildContext context,
  ) async {
    emit(AddProductLoading());
    var result = await imagesRepo.uploadImage(addProductInputEntity.image);
    result.fold(
      (f) {
        emit(AddProductFailure(f.message));
        log('Image upload failed: ${f.message}');
      },
      (url) async {
        addProductInputEntity.imageUrl = url;
        var result = await productsRepo.addProduct(addProductInputEntity);
        result.fold(
          (f) {
            emit(AddProductFailure(f.message));
          },
          (r) {
            emit(AddProductSuccess());
            ScaffoldMessenger.of(context).showSnackBar(
              const SnackBar(content: Text('Product added successfully!')),
            );
          },
        );
      },
    );
  }
}
part of 'add_product_cubit.dart';

@immutable
sealed class AddProductState {}

final class AddProductInitial extends AddProductState {}

final class AddProductLoading extends AddProductState {}

final class AddProductFailure extends AddProductState {
  final String errMessage;

  AddProductFailure(this.errMessage);
}

final class AddProductSuccess extends AddProductState {}
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/core/repos/images_repo.dart';
import 'package:fruits_hub_dashboard/core/repos/products_repo.dart';
import 'package:fruits_hub_dashboard/core/service/get_it_service.dart';
import 'package:fruits_hub_dashboard/core/widgets/build_app_bar.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/manger/add_product_cubit/cubit/add_product_cubit.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/views/widgets/add_product_view_body.dart';
import 'package:flutter_bloc/flutter_bloc.dart';

class AddProductView extends StatelessWidget {
  const AddProductView({super.key});
  static const routeName = 'add-product';
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: buildAppBar('Add Product'),
      body: BlocProvider(
        create:
            (context) => AddProductCubit(
              getIt.get<ImagesRepo>(),
              getIt.get<ProductsRepo>(),
            ),
        child: AddProductViewBody(),
      ),
    );
  }
}
import 'dart:io';

import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:fruits_hub_dashboard/core/widgets/custom_button.dart';
import 'package:fruits_hub_dashboard/core/widgets/custom_text_field.dart';
import 'package:fruits_hub_dashboard/domain/entities/add_product_input_entity.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/manger/add_product_cubit/cubit/add_product_cubit.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/views/widgets/image_field.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/views/widgets/is_featured_check_box.dart';

class AddProductViewBody extends StatefulWidget {
  const AddProductViewBody({super.key});

  @override
  State<AddProductViewBody> createState() => _AddProductViewBodyState();
}

class _AddProductViewBodyState extends State<AddProductViewBody> {
  final GlobalKey<FormState> _formKey = GlobalKey<FormState>();
  AutovalidateMode autovalidateMode = AutovalidateMode.disabled;
  File? image;
  bool isFeatured = false;
  late String name, code, description;
  late num price;
  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: EdgeInsets.symmetric(horizontal: 16),
      child: SingleChildScrollView(
        child: Form(
          key: _formKey,
          autovalidateMode: autovalidateMode,
          child: Column(
            children: [
              CustomTextFormField(
                onSaved: (value) {
                  name = value!;
                },
                hintText: 'Product Name',
                textInputType: TextInputType.text,
              ),
              SizedBox(height: 16),
              CustomTextFormField(
                onSaved: (Value) {
                  price = num.parse(Value!);
                },
                hintText: 'Product Price',
                textInputType: TextInputType.number,
              ),
              SizedBox(height: 16),
              CustomTextFormField(
                onSaved: (value) {
                  code = value!;
                },

                hintText: 'Product Code',
                textInputType: TextInputType.number,
              ),
              SizedBox(height: 16),
              CustomTextFormField(
                onSaved: (value) {
                  description = value!;
                },

                hintText: 'Product Description',
                textInputType: TextInputType.text,
                maxLines: 5,
              ),
              SizedBox(height: 16),
              IsFeaturedCheckBox(
                onChanged: (value) {
                  isFeatured = value;
                },
              ),
              SizedBox(height: 16),
              ImageField(
                onFileChanged: (image) {
                  this.image = image;
                },
              ),
              SizedBox(height: 24),
              CustomButton(
                onPressed: () {
                  if (image != null) {
                    if (_formKey.currentState!.validate()) {
                      _formKey.currentState!.save();
                      AddProductInputEntity input = AddProductInputEntity(
                        name: name,
                        code: code,
                        description: description,
                        price: price,
                        image: image!,
                        isFeatured: isFeatured,
                      );
                      context.read<AddProductCubit>().addProductC(
                        input,
                        context,
                      );
                    } else {
                      autovalidateMode = AutovalidateMode.always;
                      setState(() {});
                    }
                  } else {
                    ScaffoldMessenger.of(context).showSnackBar(
                      SnackBar(content: Text('Please select an image')),
                    );
                  }
                },
                text: "Add Product",
              ),
              SizedBox(height: 24),
            ],
          ),
        ),
      ),
    );
  }
}
import 'dart:io';

import 'package:flutter/material.dart';
import 'package:image_picker/image_picker.dart';
import 'package:skeletonizer/skeletonizer.dart';

class ImageField extends StatefulWidget {
  const ImageField({super.key, required this.onFileChanged});
  final ValueChanged<File?> onFileChanged;
  @override
  State<ImageField> createState() => _ImageFieldState();
}

class _ImageFieldState extends State<ImageField> {
  bool isLoading = false;
  File? fileImage;
  @override
  Widget build(BuildContext context) {
    return Skeletonizer(
      enabled: isLoading,
      child: GestureDetector(
        onTap: () async {
          isLoading = true;
          setState(() {});
          try {
            await prickImage();
          } catch (e) {
            isLoading = false;
            setState(() {});
          }
          isLoading = false;
          setState(() {});
        },
        child: Stack(
          children: [
            Container(
              width: double.infinity,
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(16),
                border: Border.all(color: Colors.grey),
              ),
              child:
                  fileImage != null
                      ? ClipRRect(
                        borderRadius: BorderRadius.circular(16),
                        child: Image.file(fileImage!),
                      )
                      : const Icon(Icons.image_outlined, size: 180),
            ),
            Visibility(
              visible: fileImage != null,
              child: IconButton(
                onPressed: () {
                  fileImage = null;
                  widget.onFileChanged(fileImage);
                  setState(() {});
                },
                icon: const Icon(Icons.close, color: Colors.red),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Future<void> prickImage() async {
    final ImagePicker picker = ImagePicker();

    final XFile? image = await picker.pickImage(source: ImageSource.gallery);
    fileImage = File(image!.path);

    widget.onFileChanged(fileImage!);
  }
}
import 'package:flutter/material.dart';
import 'package:flutter/widgets.dart';
import 'package:fruits_hub_dashboard/core/widgets/custom_check_box.dart';

import '../../../../../core/utils/app_text_styles.dart';

class IsFeaturedCheckBox extends StatefulWidget {
  const IsFeaturedCheckBox({super.key, required this.onChanged});

  final ValueChanged<bool> onChanged;
  @override
  State<IsFeaturedCheckBox> createState() => _IsFeaturedCheckBoxState();
}

class _IsFeaturedCheckBoxState extends State<IsFeaturedCheckBox> {
  bool isTermsAccepted = false;
  @override
  Widget build(BuildContext context) {
    return Row(
      children: [
        Text.rich(
          TextSpan(
            children: [
              TextSpan(
                text: 'is Featured Item?',
                style: TextStyles.semiBold13.copyWith(
                  color: const Color(0xFF949D9E),
                ),
              ),
            ],
          ),
          textAlign: TextAlign.right,
        ),
        Spacer(),
        CustomCheckBox(
          onChecked: (value) {
            isTermsAccepted = value;
            widget.onChanged(value);
            setState(() {});
          },
          isChecked: isTermsAccepted,
        ),
        const SizedBox(width: 16),
      ],
    );
  }
}
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/features/dashboard/presentation/views/widgets/dashboard_view_body.dart';

class DashboardView extends StatelessWidget {
  const DashboardView({super.key});
  static const routeName = 'dashboard';
  @override
  Widget build(BuildContext context) {
    return const Scaffold(body: DashboardViewBody());
  }
}
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:fruits_hub_dashboard/core/helper_fun/build_snack_bar.dart';
import 'package:fruits_hub_dashboard/core/widgets/custom_progress_hud.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/manger/add_product_cubit/cubit/add_product_cubit.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/views/widgets/add_product_view_body.dart';

class AddProductsViewBodyBlocConsumer extends StatelessWidget {
  const AddProductsViewBodyBlocConsumer({super.key});

  @override
  Widget build(BuildContext context) {
    return BlocConsumer<AddProductCubit, AddProductState>(
      listener: (context, state) {
        if (state is AddProductSuccess) {
          buildSnackBar(context, 'Product added successfully');
        }
        if (state is AddProductFailure) {
          buildSnackBar(context, state.errMessage);
        }
      },
      builder: (context, state) {
        return CustomProgressHud(
          isLoading: state is AddProductLoading,
          child: const AddProductViewBody(),
        );
      },
    );
  }
}
import 'package:flutter/material.dart';
import 'package:fruits_hub_dashboard/core/widgets/custom_button.dart';
import 'package:fruits_hub_dashboard/features/add_product/presentation/views/add_product_view.dart';

class DashboardViewBody extends StatelessWidget {
  const DashboardViewBody({super.key});

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.symmetric(horizontal: 16),
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          CustomButton(
            onPressed: () {
              Navigator.pushNamed(context, AddProductView.routeName);
            },
            text: 'Add Data',
          ),
        ],
      ),
    );
  }
}
